{% extends 'layout/inner_page.html' %}

{% load staticfiles %}
{% load pages_extras %}
{% load stb_extras %}

{% block content %}
  {% include 'components/breadcrumbs.html' with page=page only %}

  {% include 'components/page_h1.html' with page=page product=product only %}

  <section class="product-serial text-center">
    {% if product.code %}
      <span class="product-serial-title">Код</span>
      <span class="product-serial-val">{{ product.code }}</span>
    {% endif %}

    {% if product.specification %}
      <span class="product-serial-title">Серия</span>
      {# TODO: `specification` should be replaced by `spec` #}
      <span class="product-serial-val">{{ product.specification }}</span>
    {% endif %}

    {% if product.mark %}
      <span class="product-serial-title">Марка</span>
      <span class="product-serial-val">{{ product.mark }}</span>
    {% endif %}
  </section>

  <section class="product-info">
    <div class="container container-fluid">
      <div class="row">
        <div class="col-xs-offset-1 col-xs-6">
          <div class="product-image">
            {% include 'catalog/product_image.html' with product=product only %}
          </div>

          <div class="product-characteristics">
            <h2 class="product-characteristics-title">Характеристики</h2>
            <table class="product-characteristics-table table">
              {% with url=product.category.url %}
                {% show_field_if_exist product.category 'Тип' url %}
                {# TODO: `specification` should be replaced by `spec` #}
                {% show_field_if_exist product.specification 'Рабочая документация' url %}
              {% endwith %}
              {% show_field_if_exist product.length 'Длина (мм)' %}
              {% show_field_if_exist product.width 'Ширина (мм)' %}
              {% show_field_if_exist product.height 'Высота (мм)' %}
              {% show_field_if_exist product.weight 'Масса (кг)' %}
              {% show_field_if_exist product.volume 'Объем (м<sup>3</sup>)' %}
              {% show_field_if_exist product.diameter_out 'Внешний диаметр (мм)' %}
              {% show_field_if_exist product.diameter_in 'Внутренний диаметр (мм)' %}
            </table>
          </div>
        </div>

        <div class="col-xs-5">
          <div class="product-order">
            <table class="product-order-table table">
              <tr>
                <th class="product-order-table-th">Цена</th>
                <th class="product-order-table-th">Кол-во</th>
                <th class="product-order-table-th">Итог</th>
              </tr>
              <tr>
                <td class="product-order-table-col-price js-product-price">
                  {{ product.price|format_price }}
                </td>
                <td class="product-order-table-col-count">
                  <div class="category-table-col-count-wrap">
                    {% include 'catalog/count_input.html' %}
                  </div>
                </td>
                <td class="product-order-table-col-total">
                  <span class="js-product-sum">{{ product.price|format_price }}</span>
                </td>
              </tr>
            </table>
            <div class="product-order-submit text-right">
              <input class="btn" id="buy-product" data-product-id="{{ product.id }}"
                     type="submit" value="Заказать">
            </div>
          </div>

          <h2 class="product-describe-title">
            Производство ЖБИ: {{ page.h1 }} марки {{ product.mark }}
          </h2>
          <div class="product-describe-text">
            {# TODO: https://goo.gl/arjtqq #}
            {% autoescape off %}{{ page.content }}{% endautoescape %}
          </div>
        </div>
      </div>
    </div>
  </section>

  {% if sibling_with_images %}
    {% include 'catalog/product_siblings.html' with sibling_with_images=sibling_with_images only %}
  {% endif %}
{% endblock %}
